# Règles Suricata pour SIAC-IoT
# Détection MQTT
alert tcp any any -> any 1883 (msg:"MQTT Connection Detected"; flow:established; content:"MQTT"; depth:4; sid:1000001; rev:1;)
alert tcp any any -> any 8883 (msg:"MQTT over TLS Connection Detected"; flow:established; content:"|16 03|"; depth:3; sid:1000002; rev:1;)

# Détection brute force MQTT
alert tcp any any -> any 1883 (msg:"Potential MQTT Brute Force"; threshold:type threshold, track by_src, count 10, seconds 60; sid:1000003; rev:1;)

# Détection scans Nmap
alert tcp any any -> any any (msg:"Nmap SYN Scan"; flags:S; threshold:type threshold, track by_src, count 5, seconds 10; sid:1000004; rev:1;)

# Alertes générales
alert ip any any -> any any (msg:"Suspicious Traffic"; sid:1000005; rev:1;)